#!/usr/bin/python3.11

import sys

PC1 = [57, 49, 41, 33, 25, 17, 9, 1, 58, 50, 42, 34, 26, 18, 10, 2, 59, 51, 43, 35, 27, 19, 11, 3, 60, 52, 44, 36, 63, 55, 47, 39, 31, 23, 15, 7, 62, 54, 46, 38, 30, 22, 14, 6, 61, 53, 45, 37, 29, 21, 13, 5, 28, 20, 12, 4]

LSH_TABLE = [1, 1, 2, 2, 2, 2, 2, 2, 1, 2, 2, 2, 2, 2, 2, 1]

PC2 = [14, 17, 11, 24, 1, 5, 3, 28, 15, 6, 21, 10, 23, 19, 12, 4, 26, 8, 16, 7, 27, 20, 13, 2, 41, 52, 31, 37, 47, 55, 30, 40, 51, 45, 33, 48, 44, 49, 39, 56, 34, 53, 46, 42, 50, 36, 29, 32]

KEY_VALUES = ['000110110000001011101111111111000111000001110010', \
              '011110011010111011011001110110111100100111100101', \
              '010101011111110010001010010000101100111110011001', \
              '011100101010110111010110110110110011010100011101', \
              '011111001110110000000111111010110101001110101000', \
              '011000111010010100111110010100000111101100101111', \
              '111011001000010010110111111101100001100010111100', \
              '111101111000101000111010110000010011101111111011', \
              '111000001101101111101011111011011110011110000001', \
              '101100011111001101000111101110100100011001001111', \
              '001000010101111111010011110111101101001110000110', \
              '011101010111000111110101100101000110011111101001', \
              '100101111100010111010001111110101011101001000001', \
              '010111110100001110110111111100101110011100111010', \
              '101111111001000110001101001111010011111100001010', \
              '110010110011110110001011000011100001011111110101']

def left_shift(b: list[str], n: int) -> list[str]:
    orig_key = b.copy()
    for i in range(len(b)):
        b[i] = orig_key[(i+n)%len(b)]
    return b

if __name__ == '__main__':

    testing = False 

    f = open('key.txt', 'r')
    KEY = f.readline().strip()
    f.close()

    KEYS = [list() for _ in range(16)]

    PC_KEY = [KEY[loc-1] for loc in PC1]
    if testing:
        assert ''.join(PC_KEY) == '11110000110011001010101011110101010101100110011110001111'

    # Perform these operations 16 times
    for i in range(16):

        # Create the C0 and D0 keys
        C0 = PC_KEY[:28]
        D0 = PC_KEY[28:]

        # Perform the left shifts
        C0 = left_shift(C0, LSH_TABLE[i])
        D0 = left_shift(D0, LSH_TABLE[i])

        # Combine to make next PC_KEY
        PC_KEY = C0.copy() + D0.copy()

        # Perform permutation
        KEYS[i] = [PC_KEY[loc-1] for loc in PC2]

        # Check for assertion
        if testing:
            assert ''.join(KEYS[i]) == KEY_VALUES[i]

    for k in KEYS:
        print(''.join(k))
